# ZMQ 简介

 - ZeroMQ: http://www.zeromq.org
 - ZeroMQ API: http://api.zeromq.org/
 - ZGuide: http://zguide.zeromq.org/
 - ZGuide Example: https://github.com/booksbyus/zguide

## ZMQ 提供的 Socket 协议:
 - 单播传输协议（inporc, ipc, tcp）
 - 两个广播协议（epgm, pgm)

## ZMQ的核心消息模式（ZMQ Basic Message Patterns）:

 - **请求-应答模式(REQ-REP)**:  
    将一组服务端和一组客户端相连，用于远程过程调用或任务分发。
 - **发布-订阅模式(PUB-SUB)**:  
    将一组发布者和一组订阅者相连，用于数据分发。  
 - **管道模式(Pipeline)**:  
    使用扇入或扇出的形式组装多个节点，可以产生多个步骤或循环，用于构建并行处理架构。 
 - **排他对接模式(Pair)**:  
    将两个套接字一对一地连接起来，（这种模式应用场景很少） 

## ZMQ 合法的套接字连接-绑定对（一端绑定、一端连接）：

 - PUB - SUB
 - REQ - REP
 - REQ - ROUTER
 - DEALER - REP
 - DEALER - ROUTER
 - DEALER - DEALER
 - ROUTER - ROUTER
 - PUSH - PULL
 - PAIR - PAIR

--------------------------------------

ZMQ（ØMQ、ZeroMQ, 0MQ）
 - 看起来像是一套嵌入式的网络链接库，但工作起来更像是一个并发式的框架。
 - 提供的套接字可以在多种协议中传输消息，如线程间、进程间、TCP、广播等。
 - 可以使用套接字构建多对多的连接模式，如扇出、发布-订阅、任务分发、请求-应答等。
 - ZMQ的快速足以胜任集群应用产品。
 - 异步I/O机制能够支持构建多核应用程序，完成异步消息处理任务。
 - ZMQ有着多语言支持，并能在几乎所有的操作系统上运行。
 - ZMQ是iMatix公司的产品，以LGPL开源协议发布。
 
ZMQ之所那么吸引人眼球，原因之一就是它是建立在标准套接字API之上。因此，ZMQ的套接字操作非常容易理解，其生命周期主要包含四个部分：

 - 创建和销毁套接字：zmq_socket(), zmq_close()
 - 配置和读取套接字选项：zmq_setsockopt(), zmq_getsockopt()
 - 为套接字建立连接：zmq_bind(), zmq_connect()
 - 发送和接收消息：zmq_send(), zmq_recv()
 
ZMQ连接和传统的TCP连接是有区别的，主要有：

 - 使用多种协议，inproc（进程内）、ipc（进程间）、tcp、pgm（广播）、epgm；
 - 当客户端使用zmq_connect()时连接就已经建立了，并不要求该端点已有某个服务使用zmq_bind()进行了绑定；
 - 连接是异步的，并由一组消息队列做缓冲；
 - 连接会表现出某种消息模式，这是由创建连接的套接字类型决定的；
 - 一个套接字可以有多个输入和输出连接；
 - ZMQ没有提供类似zmq_accept()的函数，因为当套接字绑定至端点时它就自动开始接受连接了；
 - 应用程序无法直接和这些连接打交道，因为它们是被封装在ZMQ底层的。
 
TCP套接字和ZMQ套接字之间在传输数据方面的区别：

 - ZMQ套接字传输的是消息，而不是字节（TCP）或帧（UDP）。消息指的是一段指定长度的二进制数据块，我们下文会讲到消息，这种设计是为了性能优化而考虑的，所以可能会比较难以理解。
 - ZMQ套接字在后台进行I/O操作，也就是说无论是接收还是发送消息，它都会先传送到一个本地的缓冲队列，这个内存队列的大小是可以配置的。
 - ZMQ套接字可以和多个套接字进行连接（如果套接字类型允许的话）。TCP协议只能进行点对点的连接，而ZMQ则可以进行一对多（类似于无线广播）、多对多（类似于邮局）、多对一（类似于信箱），当然也包括一对一的情况。
 - ZMQ套接字可以发送消息给多个端点（扇出模型），或从多个端点中接收消息（扇入模型）


 
单播传输

 - 一般而言我们会使用tcp作为传输协议，这种TCP连接是可以脱机运作的，它灵活、便携、且足够快速。为什么称之为脱机，是因为ZMQ中的TCP连接不需要该端点已经有某个服务进行了绑定，客户端和服务端可以随时进行连接和绑定，这对应用程序而言都是透明的。
 - 进程间协议，即ipc，和tcp的行为差不多，但已从网络传输中抽象出来，不需要指定IP地址或者域名。这种协议很多时候会很方便，本指南中的很多示例都会使用这种协议。ZMQ中的ipc协议同样可以是脱机的，但有一个缺点——无法在Windows操作系统上运作，这一点也许会在未来的ZMQ版本中修复。我们一般会在端点名称的末尾附上.ipc的扩展名，在UNIX系统上，使用ipc协议还需要注意权限问题。你还需要保证所有的程序都能够找到这个ipc端点。
 - 进程内协议，即inproc，可以在同一个进程的不同线程之间进行消息传输，它比ipc或tcp要快得多。这种协议有一个要求，必须先绑定到端点，才能建立连接，也许未来也会修复。通常的做法是先启动服务端线程，绑定至端点，后启动客户端线程，连接至端点。
 



